# è‚¡ç¥¨çŸ­æœŸæ¶¨è·Œé¢„æµ‹ç³»ç»Ÿ

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

> åŸºäºæ·±åº¦å­¦ä¹ å’Œç»å…¸æ—¶åºæ¨¡å‹çš„è‚¡ç¥¨æ¶¨è·Œé¢„æµ‹ç³»ç»Ÿï¼Œå®ç°äº†å®Œæ•´çš„ç«¯åˆ°ç«¯æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [ä¸»è¦ç‰¹ç‚¹](#ä¸»è¦ç‰¹ç‚¹)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æŠ€æœ¯æŒ‡æ ‡](#æŠ€æœ¯æŒ‡æ ‡)
- [æ¨¡å‹è¯´æ˜](#æ¨¡å‹è¯´æ˜)
- [æ•°æ®é›†è¯´æ˜](#æ•°æ®é›†è¯´æ˜)
- [é˜²æ­¢æ—¶é—´æ³„æ¼](#é˜²æ­¢æ—¶é—´æ³„æ¼)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
- [è¯„ä¼°æŒ‡æ ‡](#è¯„ä¼°æŒ‡æ ‡)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- [æœªæ¥æ‰©å±•](#æœªæ¥æ‰©å±•)
- [å‚è€ƒæ–‡çŒ®](#å‚è€ƒæ–‡çŒ®)
- [License](#license)

## é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®åˆ©ç”¨å†å²ä»·æ ¼ä¸æŠ€æœ¯æŒ‡æ ‡æ•°æ®ï¼Œé¢„æµ‹ä¸ªè‚¡ä¸‹ä¸€äº¤æ˜“æ—¥çš„æ¶¨è·Œæ–¹å‘ï¼ˆäºŒåˆ†ç±»ä»»åŠ¡ï¼‰ã€‚é¡¹ç›®ä»æ•°æ®è·å–åˆ°æ¨¡å‹è¯„ä¼°ï¼Œå®ç°äº†å®Œæ•´çš„ç«¯åˆ°ç«¯æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹ï¼ŒåŒ…å«æ•°æ®å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹è®­ç»ƒå’Œç»“æœè¯„ä¼°ç­‰å…¨éƒ¨ç¯èŠ‚ã€‚

**é¡¹ç›®äº®ç‚¹**ï¼š
- ğŸ“Š 40+ç§ç»å…¸æŠ€æœ¯æŒ‡æ ‡
- ğŸ¤– 6ç§æ¨¡å‹ï¼ˆMLPã€LSTMã€Transformerã€Mambaã€ARIMAã€Prophetï¼‰
- ğŸ”’ ä¸¥æ ¼é˜²æ­¢æ—¶é—´æ³„æ¼
- ğŸ“ˆ å®Œæ•´çš„è¯„ä¼°ä½“ç³»
- ğŸ› ï¸ å·¥ç¨‹åŒ–ä»£ç ç»“æ„

## ä¸»è¦ç‰¹ç‚¹

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

- **å¤šæ•°æ®æºæ”¯æŒ**ï¼šæ”¯æŒä»yfinanceã€akshareç­‰æ•°æ®æºè·å–ä¸Šè¯50æˆåˆ†è‚¡æ•°æ®
- **ä¸°å¯Œçš„æŠ€æœ¯æŒ‡æ ‡**ï¼šåŒ…å«40+ç§ç»å…¸æŠ€æœ¯æŒ‡æ ‡ï¼Œæ¶µç›–è¶‹åŠ¿ã€åŠ¨é‡ã€æ³¢åŠ¨ç‡ã€æˆäº¤é‡å››å¤§ç±»
- **ä¸¥æ ¼é˜²æ—¶é—´æ³„æ¼**ï¼šä¸¥æ ¼çš„æ—¶é—´åºåˆ—åˆ‡åˆ†ï¼Œç¡®ä¿è®­ç»ƒé›†ä¸åŒ…å«æœªæ¥ä¿¡æ¯
- **å¤šç§æ¨¡å‹å®ç°**ï¼š
  - æ·±åº¦å­¦ä¹ ï¼šMLPï¼ˆåŸºçº¿ï¼‰ã€LSTMã€Transformerã€Mamba
  - ç»Ÿè®¡æ¨¡å‹ï¼šARIMAã€Prophet
- **å®Œæ•´è¯„ä¼°ä½“ç³»**ï¼šæä¾›Accuracyã€Precisionã€Recallã€F1-Scoreã€AUCç­‰å¤šç»´åº¦æŒ‡æ ‡
- **å·¥ç¨‹åŒ–å®è·µ**ï¼šæ¨¡å—åŒ–ä»£ç ã€é…ç½®ç®¡ç†ã€è‡ªåŠ¨åŒ–è„šæœ¬ã€å®Œæ•´æ–‡æ¡£

### âœ¨ æŠ€æœ¯äº®ç‚¹

1. **é˜²æ—¶é—´æ³„æ¼è®¾è®¡**
```python
# ä¸¥æ ¼æŒ‰æ—¶é—´åˆ‡åˆ†ï¼Œä¸æ‰“ä¹±æ•°æ®
X_train = X[:train_size]
X_val = X[train_size:train_size+val_size]
X_test = X[train_size+val_size:]

# æ ‡å‡†åŒ–åªä½¿ç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡
scaler.fit(X_train)
X_val = scaler.transform(X_val)
X_test = scaler.transform(X_test)

# ç›®æ ‡ä½¿ç”¨æœªæ¥æ•°æ®
df['target'] = (df['close'].shift(-1) > df['close']).astype(int)
```

2. **ä¸°å¯Œçš„æŠ€æœ¯æŒ‡æ ‡**
   - 4å¤§ç±»20+ç§æŒ‡æ ‡
   - æ ‡å‡†åŒ–å®ç°æ–¹å¼
   - è‡ªåŠ¨å¤„ç†NaNå€¼

3. **å¤šæ ·åŒ–æ¨¡å‹**
   - ä»ç®€å•åˆ°å¤æ‚
   - ä»ä¼ ç»Ÿåˆ°å‰æ²¿
   - ç»Ÿä¸€æ¥å£è®¾è®¡

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- pip
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äºä¸‹è½½æ•°æ®ï¼‰
- ï¼ˆå¯é€‰ï¼‰CUDAæ”¯æŒçš„GPU

### å®‰è£…æ­¥éª¤

#### æ–¹æ³•1ï¼šä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰

**Linux/Mac:**
```bash
chmod +x run.sh
./run.sh
```

**Windows:**
```cmd
run.bat
```

#### æ–¹æ³•2ï¼šæ‰‹åŠ¨å®‰è£…

1. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
python -m venv venv
```

2. **æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ**

Linux/Mac:
```bash
source venv/bin/activate
```

Windows:
```cmd
venv\Scripts\activate
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

**æ³¨æ„**ï¼šå¦‚æœå®‰è£…mamba-ssmé‡åˆ°é—®é¢˜ï¼ˆéœ€è¦CUDAï¼‰ï¼Œå¯ä»¥è·³è¿‡ï¼š
```bash
# ç¼–è¾‘ requirements.txtï¼Œæ³¨é‡Šæ‰ mamba-ssm ç›¸å…³è¡Œ
# é¡¹ç›®ä¼šè‡ªåŠ¨ä½¿ç”¨GRUä½œä¸ºMambaçš„æ›¿ä»£
```

### è¿è¡Œé¡¹ç›®

#### å®Œæ•´æµç¨‹
```bash
python main.py
```

è¿™å°†æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
1. ä¸‹è½½è‚¡ç¥¨æ•°æ®ï¼ˆè´µå·èŒ…å°ã€æ‹›å•†é“¶è¡Œã€ä¸­å›½å¹³å®‰ç­‰ï¼‰
2. è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
3. æ„é€ æ—¶é—´åºåˆ—æ ·æœ¬
4. è®­ç»ƒæ‰€æœ‰æ¨¡å‹
5. è¯„ä¼°å¹¶ç”ŸæˆæŠ¥å‘Š

#### åˆ†æ­¥æ‰§è¡Œ

```bash
# ä»…ä¸‹è½½æ•°æ®
python main.py --step download

# ä»…è®­ç»ƒæ¨¡å‹
python main.py --step train

# è®­ç»ƒç‰¹å®šæ¨¡å‹
python main.py --step train --model mlp,lstm

# ä»…è¯„ä¼°
python main.py --step evaluate
```

#### æµ‹è¯•é…ç½®
```bash
python test_setup.py
```

## æŠ€æœ¯æŒ‡æ ‡

é¡¹ç›®å®ç°äº†40+ç§ç»å…¸æŠ€æœ¯æŒ‡æ ‡ï¼Œåˆ†ä¸ºå››å¤§ç±»ï¼š

### ğŸ“ˆ è¶‹åŠ¿æŒ‡æ ‡
- **SMA/EMA**ï¼šç®€å•/æŒ‡æ•°ç§»åŠ¨å¹³å‡çº¿ï¼ˆ5, 10, 20, 30, 60æ—¥ï¼‰
- **MACD**ï¼šç§»åŠ¨å¹³å‡æ”¶æ•›å‘æ•£æŒ‡æ ‡ï¼ˆå¿«çº¿ã€æ…¢çº¿ã€æŸ±çŠ¶å›¾ï¼‰
- **ADX**ï¼šå¹³å‡è¶‹å‘æŒ‡æ•°

### ğŸ’ª åŠ¨é‡æŒ‡æ ‡
- **RSI**ï¼šç›¸å¯¹å¼ºå¼±æŒ‡æ•°
- **Stochastic**ï¼šéšæœºæŒ‡æ ‡ï¼ˆKå€¼ã€Då€¼ï¼‰
- **CCI**ï¼šå•†å“é€šé“æŒ‡æ•°
- **Williams %R**ï¼šå¨å»‰æŒ‡æ ‡
- **ROC**ï¼šå˜åŠ¨é€Ÿç‡
- **Momentum**ï¼šåŠ¨é‡æŒ‡æ ‡

### ğŸ“Š æ³¢åŠ¨ç‡æŒ‡æ ‡
- **Bollinger Bands**ï¼šå¸ƒæ—å¸¦ï¼ˆä¸Šè½¨ã€ä¸­è½¨ã€ä¸‹è½¨ï¼‰
- **ATR**ï¼šå¹³å‡çœŸå®æ³¢åŠ¨å¹…åº¦
- **Volatility**ï¼šå†å²æ³¢åŠ¨ç‡ï¼ˆ10, 20, 30æ—¥ï¼‰
- **BB Width**ï¼šå¸ƒæ—å¸¦å®½åº¦
- **BB Position**ï¼šä»·æ ¼åœ¨å¸ƒæ—å¸¦ä¸­çš„ä½ç½®

### ğŸ“¦ æˆäº¤é‡æŒ‡æ ‡
- **OBV**ï¼šèƒ½é‡æ½®æŒ‡æ ‡
- **Volume MA**ï¼šæˆäº¤é‡ç§»åŠ¨å¹³å‡
- **MFI**ï¼šèµ„é‡‘æµé‡æŒ‡æ•°
- **Volume Ratio**ï¼šæˆäº¤é‡æ¯”ç‡

### ğŸ¯ å…¶ä»–æŒ‡æ ‡
- æ¶¨è·Œå¹…ã€å¯¹æ•°æ”¶ç›Šç‡
- é«˜ä½ä»·å·®ã€æŒ¯å¹…
- å¼€ç›˜æ¶¨è·Œå¹…ã€æ—¥å†…æ¶¨è·Œå¹…
- ä»·æ ¼ä½ç½®ï¼ˆ10, 20, 30æ—¥ï¼‰
- è·ç¦»é«˜ä½ç‚¹

## æ¨¡å‹è¯´æ˜

### 1. MLP (å¤šå±‚æ„ŸçŸ¥æœº)
- **ç±»å‹**ï¼šå‰é¦ˆç¥ç»ç½‘ç»œ
- **ç”¨é€”**ï¼šåŸºçº¿æ¨¡å‹
- **ç‰¹ç‚¹**ï¼š
  - ç®€å•é«˜æ•ˆ
  - å¸¦æ³¨æ„åŠ›æœºåˆ¶å˜ä½“
  - é€‚åˆå¿«é€Ÿå®éªŒ

### 2. LSTM (é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ)
- **ç±»å‹**ï¼šå¾ªç¯ç¥ç»ç½‘ç»œ
- **ç”¨é€”**ï¼šæ—¶åºå»ºæ¨¡
- **ç‰¹ç‚¹**ï¼š
  - æ ‡å‡†åŒå‘LSTM
  - å¸¦æ³¨æ„åŠ›æœºåˆ¶
  - å †å LSTMï¼ˆå¸¦æ®‹å·®è¿æ¥ï¼‰
  - æ“…é•¿æ•æ‰é•¿æœŸä¾èµ–

### 3. Transformer
- **ç±»å‹**ï¼šæ³¨æ„åŠ›æœºåˆ¶æ¨¡å‹
- **ç”¨é€”**ï¼šå¹¶è¡Œæ—¶åºå»ºæ¨¡
- **ç‰¹ç‚¹**ï¼š
  - æ ‡å‡†Transformerç¼–ç å™¨
  - å¸¦CLS tokenå˜ä½“
  - æ—¶åºä¸“ç”¨Transformer
  - ä½ç½®ç¼–ç 

### 4. Mamba
- **ç±»å‹**ï¼šçŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMï¼‰
- **ç”¨é€”**ï¼šé«˜æ•ˆé•¿åºåˆ—å»ºæ¨¡
- **ç‰¹ç‚¹**ï¼š
  - æœ€æ–°çš„SSMæ¶æ„
  - æ··åˆæ¨¡å‹å˜ä½“
  - GRU fallbackï¼ˆæ— CUDAæ—¶ï¼‰
  - é«˜æ•ˆçš„åºåˆ—å»ºæ¨¡

### 5. ARIMA
- **ç±»å‹**ï¼šç»Ÿè®¡æ—¶åºæ¨¡å‹
- **ç”¨é€”**ï¼šä¼ ç»Ÿæ—¶åºé¢„æµ‹
- **ç‰¹ç‚¹**ï¼š
  - è‡ªå›å½’ç§¯åˆ†æ»‘åŠ¨å¹³å‡
  - æ”¯æŒå¤–ç”Ÿå˜é‡ï¼ˆSARIMAXï¼‰
  - ç»å…¸ç»Ÿè®¡æ–¹æ³•

### 6. Prophet
- **ç±»å‹**ï¼šåŠ æ€§å›å½’æ¨¡å‹
- **ç”¨é€”**ï¼šè¶‹åŠ¿å’Œå­£èŠ‚æ€§å»ºæ¨¡
- **ç‰¹ç‚¹**ï¼š
  - Facebookå¼€æº
  - è€ƒè™‘è¶‹åŠ¿å’Œå­£èŠ‚æ€§
  - æ”¯æŒå¤šå›å½’å˜é‡

## æ•°æ®é›†è¯´æ˜

### æ•°æ®æº
- **è‚¡ç¥¨æ± **ï¼šä¸Šè¯50æˆåˆ†è‚¡
  - 600519 è´µå·èŒ…å°
  - 600036 æ‹›å•†é“¶è¡Œ
  - 601318 ä¸­å›½å¹³å®‰
  - 600030 ä¸­ä¿¡è¯åˆ¸
  - 600887 ä¼Šåˆ©è‚¡ä»½

### æ•°æ®ç‰¹å¾
- **æ—¶é—´èŒƒå›´**ï¼š2019-01-01 è‡³ä»Š
- **æ•°æ®é¢‘ç‡**ï¼šæ—¥çº¿æ•°æ®
- **åŸå§‹ç‰¹å¾**ï¼šå¼€ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æ”¶ç›˜ä»·ã€æˆäº¤é‡ï¼ˆOHLCVï¼‰
- **è¡ç”Ÿç‰¹å¾**ï¼š40+ä¸ªæŠ€æœ¯æŒ‡æ ‡
- **æ€»ç‰¹å¾æ•°**ï¼š45+ä¸ª

### æ ·æœ¬æ„é€ 
- **æ–¹æ³•**ï¼šæ»‘åŠ¨çª—å£
- **çª—å£å¤§å°**ï¼š30æ—¥ï¼ˆå¯é…ç½®ï¼‰
- **é¢„æµ‹ç›®æ ‡**ï¼šä¸‹1æ—¥æ¶¨è·Œæ–¹å‘

### æ•°æ®åˆ‡åˆ†
ä¸¥æ ¼æŒ‰æ—¶é—´é¡ºåºåˆ‡åˆ†ï¼Œä¸æ‰“ä¹±ï¼š
- **è®­ç»ƒé›†**ï¼š70%
- **éªŒè¯é›†**ï¼š15%
- **æµ‹è¯•é›†**ï¼š15%

## é˜²æ­¢æ—¶é—´æ³„æ¼

é¡¹ç›®å®æ–½äº†ä¸¥æ ¼çš„é˜²æ—¶é—´æ³„æ¼æªæ–½ï¼š

### 1. ä¸¥æ ¼æ—¶é—´åˆ‡åˆ†
```python
# æŒ‰æ—¶é—´é¡ºåºåˆ‡åˆ†ï¼Œä¸æ‰“ä¹±
train_size = int(n_samples * 0.7)
val_size = int(n_samples * 0.15)

X_train = X[:train_size]
X_val = X[train_size:train_size+val_size]
X_test = X[train_size+val_size:]
```

### 2. ç‰¹å¾è®¡ç®—
æ‰€æœ‰æŠ€æœ¯æŒ‡æ ‡åªä½¿ç”¨å†å²æ•°æ®ï¼š
```python
# ä½¿ç”¨rollingç¡®ä¿åªç”¨å†å²æ•°æ®
df['sma_20'] = df['close'].rolling(window=20).mean()
df['ema_10'] = df['close'].ewm(span=10).mean()
```

### 3. æ ‡å‡†åŒ–å¤„ç†
åªä½¿ç”¨è®­ç»ƒé›†çš„ç»Ÿè®¡é‡ï¼š
```python
# åªåœ¨è®­ç»ƒé›†ä¸Šfit
scaler.fit(X_train)

# ç”¨è®­ç»ƒé›†çš„ç»Ÿè®¡é‡transforméªŒè¯é›†å’Œæµ‹è¯•é›†
X_val = scaler.transform(X_val)
X_test = scaler.transform(X_test)
```

### 4. æ ‡ç­¾æ„é€ 
ä½¿ç”¨æœªæ¥æ•°æ®ä½œä¸ºæ ‡ç­¾ï¼š
```python
# ä½¿ç”¨shift(-1)è·å–ä¸‹ä¸€æ—¥æ”¶ç›˜ä»·
df['next_close'] = df['close'].shift(-1)
df['target'] = (df['next_close'] > df['close']).astype(int)
```

### 5. æ»‘åŠ¨çª—å£
ç¡®ä¿æ—¶åºæ€§ï¼š
```python
for i in range(sequence_length, len(features)):
    X.append(features[i-sequence_length:i])  # è¿‡å»30æ—¥
    y.append(targets[i])  # å½“å‰æ—¥çš„ç›®æ ‡ï¼ˆä¸‹ä¸€æ—¥æ¶¨è·Œï¼‰
```

## é¡¹ç›®ç»“æ„

```
Project/
â”œâ”€â”€ data/                      # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                   # åŸå§‹æ•°æ®
â”‚   â””â”€â”€ processed/             # å¤„ç†åçš„æ•°æ®
â”‚
â”œâ”€â”€ src/                       # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_loader.py        # æ•°æ®è·å–ï¼ˆ300è¡Œï¼‰
â”‚   â”œâ”€â”€ feature_engineering.py # ç‰¹å¾å·¥ç¨‹ï¼ˆ500è¡Œï¼‰
â”‚   â”œâ”€â”€ train.py              # è®­ç»ƒè„šæœ¬ï¼ˆ400è¡Œï¼‰
â”‚   â”œâ”€â”€ evaluate.py           # è¯„ä¼°è„šæœ¬ï¼ˆ400è¡Œï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ models/               # æ¨¡å‹å®šä¹‰
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ mlp.py            # MLPæ¨¡å‹ï¼ˆ200è¡Œï¼‰
â”‚       â”œâ”€â”€ lstm.py           # LSTMæ¨¡å‹ï¼ˆ250è¡Œï¼‰
â”‚       â”œâ”€â”€ transformer.py    # Transformeræ¨¡å‹ï¼ˆ300è¡Œï¼‰
â”‚       â”œâ”€â”€ mamba_model.py    # Mambaæ¨¡å‹ï¼ˆ250è¡Œï¼‰
â”‚       â”œâ”€â”€ arima_model.py    # ARIMAæ¨¡å‹ï¼ˆ250è¡Œï¼‰
â”‚       â””â”€â”€ prophet_model.py  # Prophetæ¨¡å‹ï¼ˆ250è¡Œï¼‰
â”‚
â”œâ”€â”€ results/                   # ç»“æœç›®å½•
â”‚   â”œâ”€â”€ models/               # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â””â”€â”€ *.csv, *.txt          # è¯„ä¼°ç»“æœ
â”‚
â”œâ”€â”€ plots/                     # å¯è§†åŒ–å›¾è¡¨
â”‚   â”œâ”€â”€ *_confusion_matrix.png
â”‚   â”œâ”€â”€ *_roc_curve.png
â”‚   â”œâ”€â”€ *_training_history.png
â”‚   â””â”€â”€ model_comparison.png
â”‚
â”œâ”€â”€ logs/                      # æ—¥å¿—æ–‡ä»¶
â”‚
â”œâ”€â”€ config.yaml               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.py                   # ä¸»æ‰§è¡Œè„šæœ¬ï¼ˆ300è¡Œï¼‰
â”œâ”€â”€ test_setup.py             # é…ç½®æµ‹è¯•è„šæœ¬
â”œâ”€â”€ requirements.txt          # ä¾èµ–æ–‡ä»¶
â”œâ”€â”€ run.sh                    # Linux/Macå¯åŠ¨è„šæœ¬
â”œâ”€â”€ run.bat                   # Windowså¯åŠ¨è„šæœ¬
â”œâ”€â”€ .gitignore                # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md                 # æœ¬æ–‡ä»¶

æ€»è®¡ï¼š13ä¸ªPythonæºæ–‡ä»¶ï¼Œ~4000è¡Œä»£ç 
```

## é…ç½®è¯´æ˜

### ç¼–è¾‘é…ç½®æ–‡ä»¶

ç¼–è¾‘ `config.yaml` æ¥ä¿®æ”¹é¡¹ç›®é…ç½®ï¼š

#### è‚¡ç¥¨ä»£ç 
```yaml
data:
  stock_codes:
    - "600519.SS"  # è´µå·èŒ…å°
    - "600036.SS"  # æ‹›å•†é“¶è¡Œ
    - "601318.SS"  # ä¸­å›½å¹³å®‰
    # æ·»åŠ æ›´å¤šè‚¡ç¥¨...
```

#### æ—¶é—´èŒƒå›´
```yaml
data:
  start_date: "2019-01-01"
  end_date: null  # nullè¡¨ç¤ºåˆ°æœ€æ–°æ—¥æœŸ
```

#### ç‰¹å¾å·¥ç¨‹å‚æ•°
```yaml
features:
  sequence_length: 30  # æ—¶é—´çª—å£å¤§å°
  prediction_horizon: 1  # é¢„æµ‹æœªæ¥å‡ å¤©
  
  indicators:
    ma_periods: [5, 10, 20, 30, 60]
    macd_fast: 12
    macd_slow: 26
    rsi_period: 14
```

#### æ¨¡å‹å‚æ•°
```yaml
models:
  mlp:
    hidden_dims: [128, 64, 32]
    dropout: 0.3
  
  lstm:
    hidden_dim: 128
    num_layers: 2
    bidirectional: true
  
  transformer:
    d_model: 128
    nhead: 8
    num_layers: 3
```

#### è®­ç»ƒå‚æ•°
```yaml
training:
  batch_size: 64
  epochs: 100
  learning_rate: 0.001
  device: "cuda"  # æˆ– "cpu"
  
  early_stopping:
    patience: 20
    min_delta: 0.001
```

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå¿«é€Ÿæµ‹è¯•
```bash
# æµ‹è¯•ç¯å¢ƒé…ç½®
python test_setup.py

# ä½¿ç”¨å°‘é‡æ•°æ®å¿«é€Ÿæµ‹è¯•
# ç¼–è¾‘ config.yaml:
# - epochs: 5
# - stock_codes: ["600519.SS"]  # åªç”¨ä¸€åªè‚¡ç¥¨

python main.py
```

### ç¤ºä¾‹2ï¼šè®­ç»ƒç‰¹å®šæ¨¡å‹
```bash
# åªè®­ç»ƒLSTMå’ŒTransformer
python main.py --step train --model lstm,transformer

# åªè®­ç»ƒMLPä½œä¸ºå¿«é€ŸåŸºçº¿
python main.py --step train --model mlp
```

### ç¤ºä¾‹3ï¼šåˆ†æ­¥æ‰§è¡Œ
```bash
# ç¬¬ä¸€æ­¥ï¼šä¸‹è½½æ•°æ®
python main.py --step download

# ç¬¬äºŒæ­¥ï¼šè®­ç»ƒæ¨¡å‹
python main.py --step train

# ç¬¬ä¸‰æ­¥ï¼šè¯„ä¼°æ¨¡å‹
python main.py --step evaluate
```

### ç¤ºä¾‹4ï¼šä½¿ç”¨è‡ªå®šä¹‰é…ç½®
```bash
# å¤åˆ¶å¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶
cp config.yaml my_config.yaml
# ç¼–è¾‘ my_config.yaml...

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®è¿è¡Œ
python main.py --config my_config.yaml
```

## è¯„ä¼°æŒ‡æ ‡

é¡¹ç›®æä¾›å¤šç»´åº¦çš„è¯„ä¼°æŒ‡æ ‡ï¼š

### åˆ†ç±»æŒ‡æ ‡
- **Accuracy**ï¼šå‡†ç¡®ç‡ = (TP + TN) / (TP + TN + FP + FN)
- **Precision**ï¼šç²¾ç¡®ç‡ = TP / (TP + FP)
- **Recall**ï¼šå¬å›ç‡ = TP / (TP + FN)
- **F1-Score**ï¼šF1åˆ†æ•° = 2 Ã— (Precision Ã— Recall) / (Precision + Recall)
- **AUC**ï¼šROCæ›²çº¿ä¸‹é¢ç§¯

### å¯è§†åŒ–è¾“å‡º
- **æ··æ·†çŸ©é˜µ**ï¼šé¢„æµ‹ç»“æœçš„æ··æ·†çŸ©é˜µçƒ­åŠ›å›¾
- **ROCæ›²çº¿**ï¼šçœŸæ­£ä¾‹ç‡vså‡æ­£ä¾‹ç‡æ›²çº¿
- **è®­ç»ƒå†å²**ï¼šè®­ç»ƒå’ŒéªŒè¯çš„æŸå¤±/å‡†ç¡®ç‡æ›²çº¿
- **æ¨¡å‹å¯¹æ¯”**ï¼šæ‰€æœ‰æ¨¡å‹çš„æ€§èƒ½å¯¹æ¯”æŸ±çŠ¶å›¾

### è¾“å‡ºæ–‡ä»¶
```
results/
â”œâ”€â”€ model_comparison.csv              # æ¨¡å‹å¯¹æ¯”è¡¨
â”œâ”€â”€ mlp_classification_report.txt    # MLPè¯¦ç»†æŠ¥å‘Š
â”œâ”€â”€ lstm_classification_report.txt   # LSTMè¯¦ç»†æŠ¥å‘Š
â””â”€â”€ ...

plots/
â”œâ”€â”€ mlp_confusion_matrix.png         # æ··æ·†çŸ©é˜µ
â”œâ”€â”€ mlp_roc_curve.png                # ROCæ›²çº¿
â”œâ”€â”€ mlp_training_history.png         # è®­ç»ƒå†å²
â”œâ”€â”€ model_comparison.png             # æ¨¡å‹å¯¹æ¯”
â””â”€â”€ ...
```

## å¸¸è§é—®é¢˜

### 1. æ•°æ®ä¸‹è½½å¤±è´¥
**é—®é¢˜**ï¼šæ— æ³•ä¸‹è½½è‚¡ç¥¨æ•°æ®

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•åˆ‡æ¢æ•°æ®æºï¼ˆåœ¨config.yamlä¸­ä¿®æ”¹ `data_source: "akshare"`ï¼‰
- ä½¿ç”¨VPNæˆ–ä»£ç†
- æ£€æŸ¥è‚¡ç¥¨ä»£ç æ˜¯å¦æ­£ç¡®

### 2. CUDA out of memory
**é—®é¢˜**ï¼šGPUå†…å­˜ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å‡å° `batch_size`ï¼ˆå¦‚ä»64æ”¹ä¸º32æˆ–16ï¼‰
- ä½¿ç”¨CPUï¼šåœ¨config.yamlä¸­è®¾ç½® `device: "cpu"`
- å‡å°‘æ¨¡å‹å¤§å°ï¼ˆå‡å°‘hidden_dimæˆ–num_layersï¼‰
- ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯

### 3. Mambaå®‰è£…å¤±è´¥
**é—®é¢˜**ï¼šmamba-ssmå®‰è£…å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é¡¹ç›®ä¼šè‡ªåŠ¨ä½¿ç”¨GRUä½œä¸ºæ›¿ä»£ï¼Œä¸å½±å“è¿è¡Œ
- æˆ–è€…æ³¨é‡Šæ‰requirements.txtä¸­çš„mamba-ssm
- æˆ–è€…è·³è¿‡Mambaæ¨¡å‹è®­ç»ƒ

### 4. è®­ç»ƒå¤ªæ…¢
**é—®é¢˜**ï¼šè®­ç»ƒæ—¶é—´è¿‡é•¿

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨GPUåŠ é€Ÿ
- å‡å°‘epochsï¼ˆå¦‚æ”¹ä¸º50æˆ–20ï¼‰
- åªè®­ç»ƒéƒ¨åˆ†æ¨¡å‹ï¼š`--model mlp,lstm`
- ä½¿ç”¨æ›´å°‘çš„è‚¡ç¥¨
- ç¼©çŸ­æ—¶é—´èŒƒå›´

### 5. å†…å­˜ä¸è¶³
**é—®é¢˜**ï¼šç³»ç»Ÿå†…å­˜ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å‡å°‘è‚¡ç¥¨æ•°é‡
- å‡å°sequence_length
- å‡å°‘æŠ€æœ¯æŒ‡æ ‡æ•°é‡
- åˆ†æ‰¹å¤„ç†æ•°æ®

## æ³¨æ„äº‹é¡¹

### âš ï¸ é‡è¦æç¤º

1. **æ•°æ®è·å–**
   - é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½æ•°æ®ï¼Œéœ€è¦æ—¶é—´
   - éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥
   - éµå®ˆæ•°æ®æºçš„ä½¿ç”¨æ¡æ¬¾å’Œé™åˆ¶

2. **è®¡ç®—èµ„æº**
   - å»ºè®®ä½¿ç”¨GPUè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹
   - éœ€è¦è¶³å¤Ÿçš„å†…å­˜ï¼ˆå»ºè®®8GB+ï¼‰
   - Mambaæ¨¡å‹éœ€è¦CUDAæ”¯æŒ

3. **æŠ•èµ„é£é™©**
   - **æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨**
   - **ä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®**
   - **å®é™…æŠ•èµ„éœ€è°¨æ…ï¼Œè¯·å’¨è¯¢ä¸“ä¸šæŠ•èµ„é¡¾é—®**
   - å†å²è¡¨ç°ä¸ä»£è¡¨æœªæ¥ç»“æœ

4. **æ•°æ®ç‰ˆæƒ**
   - éµå®ˆæ•°æ®æä¾›æ–¹çš„ä½¿ç”¨æ¡æ¬¾
   - ä¸ç”¨äºå•†ä¸šç”¨é€”
   - å°Šé‡æ•°æ®ç‰ˆæƒ

5. **æ¨¡å‹å±€é™æ€§**
   - é‡‘èå¸‚åœºå¤æ‚å¤šå˜
   - æ¨¡å‹é¢„æµ‹å­˜åœ¨ä¸ç¡®å®šæ€§
   - éœ€è¦æŒç»­ä¼˜åŒ–å’Œæ”¹è¿›

## æœªæ¥æ‰©å±•

é¡¹ç›®å¯ä»¥åœ¨ä»¥ä¸‹æ–¹å‘è¿›ä¸€æ­¥æ‰©å±•ï¼š

### ğŸ“Š æ•°æ®æ–¹å‘
- æ·»åŠ æ›´å¤šæ•°æ®æºï¼ˆTushareã€Windç­‰ï¼‰
- åŠ å…¥åŸºæœ¬é¢æ•°æ®ï¼ˆè´¢åŠ¡æŠ¥è¡¨ç­‰ï¼‰
- å¼•å…¥æ–°é—»æƒ…æ„Ÿåˆ†æ
- æ•´åˆç¤¾äº¤åª’ä½“æ•°æ®
- åŠ å…¥å®è§‚ç»æµæŒ‡æ ‡

### ğŸ¤– æ¨¡å‹æ–¹å‘
- å®ç°æ›´å¤šæ¨¡å‹ï¼ˆGRUã€Attentionã€TCNç­‰ï¼‰
- å°è¯•é›†æˆå­¦ä¹ æ–¹æ³•
- æ¢ç´¢å¼ºåŒ–å­¦ä¹ ç­–ç•¥
- å®ç°åœ¨çº¿å­¦ä¹ 
- æ¨¡å‹èåˆå’ŒStacking

### ğŸ¯ ä»»åŠ¡æ–¹å‘
- å›å½’ä»»åŠ¡ï¼ˆé¢„æµ‹å…·ä½“æ¶¨è·Œå¹…ï¼‰
- å¤šæ­¥é¢„æµ‹ï¼ˆé¢„æµ‹æœªæ¥å¤šæ—¥ï¼‰
- å¼‚å¸¸æ£€æµ‹ï¼ˆè¯†åˆ«å¼‚å¸¸äº¤æ˜“ï¼‰
- å› å­æŒ–æ˜
- é£é™©è¯„ä¼°

### ğŸ’¼ åº”ç”¨æ–¹å‘
- æ„å»ºå›æµ‹æ¡†æ¶
- å®ç°äº¤æ˜“ç­–ç•¥
- å¼€å‘é£é™©ç®¡ç†ç³»ç»Ÿ
- åˆ›å»ºå®æ—¶ç›‘æ§ç³»ç»Ÿ
- æ„å»ºWebå¯è§†åŒ–ç•Œé¢

### ğŸ”§ å·¥ç¨‹æ–¹å‘
- å®ç°åˆ†å¸ƒå¼è®­ç»ƒ
- æ·»åŠ æ¨¡å‹å‹ç¼©å’ŒåŠ é€Ÿ
- å®ç°è‡ªåŠ¨åŒ–è°ƒå‚
- æ„å»ºMLOpsæµç¨‹
- æ·»åŠ å•å…ƒæµ‹è¯•

## å‚è€ƒæ–‡çŒ®

### å­¦æœ¯è®ºæ–‡
1. **LSTM**: Hochreiter, S., & Schmidhuber, J. (1997). Long short-term memory. Neural computation, 9(8), 1735-1780.
2. **Transformer**: Vaswani, A., et al. (2017). Attention is all you need. Advances in neural information processing systems, 30.
3. **Mamba**: Gu, A., & Dao, T. (2023). Mamba: Linear-Time Sequence Modeling with Selective State Spaces. arXiv preprint arXiv:2312.00752.

### æŠ€æœ¯æŒ‡æ ‡
- Murphy, J. J. (1999). Technical analysis of the financial markets: A comprehensive guide to trading methods and applications.
- Achelis, S. B. (2000). Technical analysis from A to Z (Vol. 204). McGraw-Hill.

### æ•°æ®æº
- [Yahoo Finance API](https://finance.yahoo.com/)
- [AKShare](https://akshare.akfamily.xyz/)

## é¡¹ç›®ç»Ÿè®¡

- **ä»£ç æ€»é‡**ï¼š~4000è¡ŒPythonä»£ç 
- **æ¨¡å‹æ•°é‡**ï¼š6ä¸ªï¼ˆMLP, LSTM, Transformer, Mamba, ARIMA, Prophetï¼‰
- **æŠ€æœ¯æŒ‡æ ‡**ï¼š40+ç§ç»å…¸æŒ‡æ ‡
- **æ–‡æ¡£å®Œæ•´åº¦**ï¼š100%
- **å·¥ç¨‹å®è·µ**ï¼šâœ… æ¨¡å—åŒ–ã€é…ç½®åŒ–ã€è‡ªåŠ¨åŒ–

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

## License

MIT License

Copyright (c) 2024

---

**Happy Coding! ğŸ“ˆğŸ¤–**

*é¡¹ç›®åˆ›å»ºæ—¶é—´: 2024-11-14*  
*æœ€åæ›´æ–°: 2024-11-14*

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ [GitHub Issues](https://github.com/li147852xu/ARIN7101_Project_Stock_Prediction/issues) è”ç³»æˆ‘ä»¬ã€‚
